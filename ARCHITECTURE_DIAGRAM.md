# Vietmap Handler Architecture & Flow

## Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SMART FOOD SYSTEM                            â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   FRONTEND     â”‚              â”‚        BACKEND              â”‚   â”‚
â”‚  â”‚   (Flutter)    â”‚â—„â”€â”€â”€â”€HTTPâ”€â”€â”€â”€â–ºâ”‚      (FastAPI)              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                    â”‚                       â”‚
â”‚         â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚         â”‚                          â”‚                    â”‚           â”‚
â”‚         â”‚                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚         â”‚                    â”‚  Vietmap   â”‚      â”‚   Query    â”‚    â”‚
â”‚         â”‚                    â”‚   Router   â”‚      â”‚   Router   â”‚    â”‚
â”‚         â”‚                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                          â”‚                    â”‚           â”‚
â”‚         â”‚                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚         â”‚                    â”‚  Vietmap   â”‚      â”‚   Query    â”‚    â”‚
â”‚         â”‚                    â”‚  Handlers  â”‚      â”‚  Handler   â”‚    â”‚
â”‚         â”‚                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                          â”‚                    â”‚           â”‚
â”‚         â”‚                          â”‚                    â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                    â”‚                                â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                          â”‚   External APIs    â”‚                     â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                     â”‚
â”‚                          â”‚  â”‚  Vietmap API â”‚  â”‚                     â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                     â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                     â”‚
â”‚                          â”‚  â”‚   MongoDB    â”‚  â”‚                     â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                     â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Detailed Component Flow

### 1. Vietmap Search Flow

```
User types "Cafe Hanoi"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flutter Widget    â”‚
â”‚ (SearchBox)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ HTTP GET
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/vietmap/search?text=Cafe%20Hanoi â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ vietmap_router.py   â”‚
â”‚ search_location_get()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VietmapHandlers     â”‚
â”‚ Search()            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ HTTPS
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vietmap API         â”‚
â”‚ maps.vietmap.vn     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ JSON Response
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VietmapSearchResponseâ”‚
â”‚ (List of Places)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
    Return to Frontend
```

### 2. Restaurant Search Flow

```
User searches "restaurants near me"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flutter Widget    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/query/search/location    â”‚
â”‚ ?lat=21.0285&lng=105.8542          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ query_router.py     â”‚
â”‚ search_by_location()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QuerySystemHandler  â”‚
â”‚ search_by_location()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ MongoDB Query
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MongoDB             â”‚
â”‚ restaurants         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Documents
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QueryResult         â”‚
â”‚ (List of            â”‚
â”‚  Restaurants)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
    Return to Frontend
```

### 3. Combined Workflow (Real Use Case)

```
User: "Find restaurants in Ba Dinh"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: Geocode Location  â”‚
â”‚ GET /api/vietmap/search   â”‚
â”‚ ?text=Ba%20Dinh           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼ Returns: {lat: 21.042, lng: 105.839}
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Get Place Details â”‚
â”‚ GET /api/vietmap/place/   â”‚
â”‚     {ref_id}              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼ Returns: Exact coordinates
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Search Restaurantsâ”‚
â”‚ GET /api/query/search/    â”‚
â”‚     location              â”‚
â”‚ ?lat=21.042&lng=105.839   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
    List of Restaurants
```

## File Structure

```
Backend/
â”œâ”€â”€ app.py                         # Main FastAPI app
â”‚   â”œâ”€â”€ Registers routers
â”‚   â””â”€â”€ Error handlers
â”‚
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py               # MapCoordinate class âœ¨
â”‚   â”‚
â”‚   â”œâ”€â”€ vietmap/
â”‚   â”‚   â”œâ”€â”€ handlers.py           # VietmapHandlers API client
â”‚   â”‚   â””â”€â”€ schemas.py            # Response models
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ restaurant.py         # Restaurant models
â”‚   â”‚
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â””â”€â”€ mongodb.py            # MongoDB connection
â”‚   â”‚
â”‚   â””â”€â”€ query_handler.py          # Query system logic âœ¨
â”‚
â””â”€â”€ routers/
    â”œâ”€â”€ vietmap.py                # Vietmap endpoints âœ¨
    â””â”€â”€ query_router.py           # Query endpoints âœ¨

âœ¨ = New or Modified
```

## API Endpoints Map

```
http://localhost:8000
â”‚
â”œâ”€â”€ /docs                          # Swagger UI (Auto-generated)
â”‚
â”œâ”€â”€ /api/vietmap/
â”‚   â”œâ”€â”€ /search                    # Search locations
â”‚   â”‚   â”œâ”€â”€ GET  ?text=...
â”‚   â”‚   â””â”€â”€ POST {text: "..."}
â”‚   â”‚
â”‚   â”œâ”€â”€ /autocomplete              # Autocomplete
â”‚   â”‚   â”œâ”€â”€ GET  ?text=...
â”‚   â”‚   â””â”€â”€ POST {text: "..."}
â”‚   â”‚
â”‚   â”œâ”€â”€ /place/{ref_id}           # Place details
â”‚   â”‚   â””â”€â”€ GET
â”‚   â”‚
â”‚   â”œâ”€â”€ /reverse                   # Reverse geocode
â”‚   â”‚   â”œâ”€â”€ GET  ?lat=...&lng=...
â”‚   â”‚   â””â”€â”€ POST {lat: ..., lng: ...}
â”‚   â”‚
â”‚   â””â”€â”€ /health                    # Health check
â”‚       â””â”€â”€ GET
â”‚
â””â”€â”€ /api/query/
    â”œâ”€â”€ /search/name               # Search by name
    â”œâ”€â”€ /search/category           # Search by category
    â”œâ”€â”€ /search/location           # Search by location
    â”œâ”€â”€ /search/rating             # Search by rating
    â”œâ”€â”€ /search/combined           # Combined search
    â”œâ”€â”€ /restaurant/{id}           # Get by ID
    â”œâ”€â”€ /categories                # List categories
    â””â”€â”€ /statistics                # Get stats
```

## Data Flow Example

### Searching for "Cafe near Hoan Kiem Lake"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. USER INPUT                                                â”‚
â”‚    Query: "Cafe near Hoan Kiem Lake"                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. VIETMAP SEARCH                                            â”‚
â”‚    GET /api/vietmap/search?text=Hoan+Kiem+Lake             â”‚
â”‚                                                              â”‚
â”‚    Response:                                                 â”‚
â”‚    {                                                         â”‚
â”‚      "ref_id": "abc123",                                    â”‚
â”‚      "name": "Há»“ HoÃ n Kiáº¿m",                               â”‚
â”‚      "address": "HoÃ n Kiáº¿m, HÃ  Ná»™i"                        â”‚
â”‚    }                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. GET PLACE DETAILS                                         â”‚
â”‚    GET /api/vietmap/place/abc123                            â”‚
â”‚                                                              â”‚
â”‚    Response:                                                 â”‚
â”‚    {                                                         â”‚
â”‚      "name": "Há»“ HoÃ n Kiáº¿m",                               â”‚
â”‚      "lat": 21.0285,                                        â”‚
â”‚      "lng": 105.8542,                                       â”‚
â”‚      "city": "HÃ  Ná»™i",                                      â”‚
â”‚      "district": "HoÃ n Kiáº¿m"                                â”‚
â”‚    }                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. SEARCH RESTAURANTS                                        â”‚
â”‚    GET /api/query/search/combined                           â”‚
â”‚        ?q=Cafe                                              â”‚
â”‚        &latitude=21.0285                                    â”‚
â”‚        &longitude=105.8542                                  â”‚
â”‚        &max_distance=2000                                   â”‚
â”‚        &category=Cafe                                       â”‚
â”‚                                                              â”‚
â”‚    Response:                                                 â”‚
â”‚    {                                                         â”‚
â”‚      "success": true,                                        â”‚
â”‚      "data": [                                              â”‚
â”‚        {                                                     â”‚
â”‚          "id": "123",                                       â”‚
â”‚          "name": "Cong Caphe",                              â”‚
â”‚          "category": "Cafe",                                â”‚
â”‚          "rating": 4.5,                                     â”‚
â”‚          "latitude": 21.0288,                               â”‚
â”‚          "longitude": 105.8545                              â”‚
â”‚        },                                                    â”‚
â”‚        ...                                                   â”‚
â”‚      ],                                                      â”‚
â”‚      "total_count": 15,                                     â”‚
â”‚      "returned_count": 10                                   â”‚
â”‚    }                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. DISPLAY RESULTS                                           â”‚
â”‚    - Show on map                                            â”‚
â”‚    - List view                                              â”‚
â”‚    - Filter options                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Classes & Their Roles

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MapCoordinate      â”‚  â†’ Simple lat/lng container
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VietmapHandlers     â”‚  â†’ Communicates with Vietmap API
â”‚                      â”‚     - Search()
â”‚                      â”‚     - Autocomplete()
â”‚                      â”‚     - Place()
â”‚                      â”‚     - Reverse()
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QuerySystemHandler   â”‚  â†’ Queries MongoDB for restaurants
â”‚                      â”‚     - search_by_name()
â”‚                      â”‚     - search_by_location()
â”‚                      â”‚     - search_by_category()
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Routers            â”‚  â†’ Expose HTTP endpoints
â”‚   (vietmap.py,       â”‚     - Handle requests
â”‚    query_router.py)  â”‚     - Validate input
â”‚                      â”‚     - Return responses
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Testing Workflow

```
1. Check Health
   â†“
   GET /api/vietmap/health
   
2. Test Search
   â†“
   GET /api/vietmap/search?text=Cafe

3. Test Autocomplete
   â†“
   GET /api/vietmap/autocomplete?text=Cafe

4. Test Reverse Geocode
   â†“
   GET /api/vietmap/reverse?lat=21.0285&lng=105.8542

5. Test Query System
   â†“
   GET /api/query/search/name?q=Cafe

6. Test Combined
   â†“
   Run: python Backend/test_handlers.py
```

## Quick Reference

### Common HTTP Status Codes

- `200 OK` - Success
- `400 Bad Request` - Invalid parameters
- `404 Not Found` - No results found
- `500 Internal Server Error` - Server/API error

### Environment Variables

```env
# Required
VIETMAP_API_KEY=your_key_here

# MongoDB (from existing config)
MONGODB_CONNECTION_STRING=your_connection_string
```

### Important URLs

- API Docs: http://localhost:8000/docs
- Redoc: http://localhost:8000/redoc
- Health Check: http://localhost:8000/api/vietmap/health

## That's Your Complete System! ğŸ‰

You now have:
- âœ… Vietmap integration (geocoding, search, autocomplete)
- âœ… Query system (restaurant search)
- âœ… REST API endpoints
- âœ… Complete documentation
- âœ… Test scripts
- âœ… Type-safe models

Ready to build your Smart Food Recommendation System! ğŸš€
